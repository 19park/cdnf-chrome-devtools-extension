<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
      font-size: 11px;
      color: #222;
      background: #fff;
      display: flex;
      flex-direction: column;
      height: 100vh;
      overflow: hidden;
    }

    /* --- Toolbar --- */
    .toolbar {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 4px 8px;
      border-bottom: 1px solid #dadce0;
      background: #f3f3f3;
      flex-shrink: 0;
    }

    .toolbar .domain {
      font-weight: 600;
      color: #1a73e8;
    }

    .toolbar .count {
      color: #888;
      margin-left: auto;
      white-space: nowrap;
    }

    .toolbar button {
      padding: 2px 8px;
      font-size: 11px;
      font-family: inherit;
      cursor: pointer;
      border: 1px solid #ccc;
      border-radius: 3px;
      background: #fff;
      color: #333;
    }

    .toolbar button:hover {
      background: #e8e8e8;
    }

    .toolbar button.active {
      background: #d3e3fd;
      color: #1a73e8;
      border-color: #1a73e8;
    }

    /* --- Filter bar --- */
    .filter-bar {
      display: flex;
      align-items: center;
      gap: 2px;
      padding: 3px 8px;
      border-bottom: 1px solid #dadce0;
      background: #f8f9fa;
      flex-shrink: 0;
      flex-wrap: wrap;
    }

    .filter-btn {
      padding: 2px 8px;
      font-size: 11px;
      font-family: system-ui, -apple-system, sans-serif;
      cursor: pointer;
      border: none;
      border-radius: 3px;
      background: transparent;
      color: #5f6368;
      white-space: nowrap;
    }

    .filter-btn:hover {
      background: #e8eaed;
      color: #202124;
    }

    .filter-btn.active {
      background: #d3e3fd;
      color: #1a73e8;
      font-weight: 500;
    }

    .search-input {
      width: 160px;
      padding: 2px 6px;
      font-size: 11px;
      font-family: system-ui, -apple-system, sans-serif;
      border: 1px solid #ccc;
      border-radius: 3px;
      background: #fff;
      color: #333;
      outline: none;
    }

    .search-input:focus {
      border-color: #1a73e8;
      box-shadow: 0 0 0 1px rgba(26,115,232,0.3);
    }

    .search-input::placeholder {
      color: #999;
    }

    .filter-sep {
      width: 1px;
      height: 14px;
      background: #dadce0;
      margin: 0 4px;
    }

    /* --- Table list --- */
    .list-pane {
      flex: 1;
      overflow-y: auto;
      min-height: 60px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      table-layout: fixed;
    }

    thead {
      position: sticky;
      top: 0;
      z-index: 1;
    }

    th {
      background: #f3f3f3;
      border-bottom: 1px solid #ccc;
      padding: 3px 6px;
      text-align: left;
      font-weight: normal;
      color: #666;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    td {
      padding: 2px 6px;
      border-bottom: 1px solid #eee;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      cursor: pointer;
    }

    tr.selected td {
      background: #cfe8fc;
    }

    tr:hover td {
      background: #edf4ff;
    }

    tr.selected:hover td {
      background: #cfe8fc;
    }

    tr.hidden {
      display: none;
    }

    .col-method { width: 50px; }
    .col-status { width: 46px; }
    .col-name   { width: auto; }
    .col-type   { width: 90px; }
    .col-size   { width: 64px; text-align: right; }
    .col-time   { width: 60px; text-align: right; }

    td.col-size, th.col-size,
    td.col-time, th.col-time {
      text-align: right;
    }

    .status-err { color: #d93025; }
    .status-redirect { color: #e37400; }

    .status-pending {
      color: #999;
      font-style: italic;
    }

    tr.pending td {
      color: #999;
    }

    .size-cache {
      color: #888;
      font-size: 10px;
    }

    .path-name {
      color: #1a73e8;
      font-weight: 500;
    }

    /* New row flash */
    @keyframes row-flash {
      0%   { background: #e8f0fe; }
      100% { background: transparent; }
    }

    tr.new-row td {
      animation: row-flash 1.2s ease-out;
    }

    .empty-msg {
      padding: 24px;
      text-align: center;
      color: #999;
      font-family: system-ui, sans-serif;
    }

    /* --- Sort indicators --- */
    th[data-sort] {
      cursor: pointer;
      user-select: none;
    }

    th[data-sort]:hover {
      color: #333;
    }

    .sort-arrow {
      font-size: 9px;
      color: #999;
    }

    /* --- Slow response --- */
    .time-warn {
      color: #e37400 !important;
    }

    .time-slow {
      color: #d93025 !important;
      font-weight: 500;
    }

    /* --- Detail pane --- */
    .detail-pane {
      display: none;
      flex-direction: column;
      border-top: 1px solid #ccc;
      height: 45%;
      min-height: 120px;
      flex-shrink: 0;
    }

    .detail-pane.open {
      display: flex;
    }

    .detail-tabs {
      display: flex;
      background: #f3f3f3;
      border-bottom: 1px solid #ccc;
      flex-shrink: 0;
    }

    .detail-tab {
      padding: 4px 12px;
      cursor: pointer;
      color: #555;
      border-bottom: 2px solid transparent;
      font-family: system-ui, sans-serif;
      font-size: 11px;
    }

    .detail-tab:hover {
      color: #222;
      background: #e8e8e8;
    }

    .detail-tab.active {
      color: #1a73e8;
      border-bottom-color: #1a73e8;
    }

    .detail-close {
      margin-left: auto;
      padding: 4px 10px;
      cursor: pointer;
      color: #888;
      font-size: 13px;
      font-family: system-ui, sans-serif;
    }

    .detail-close:hover {
      color: #222;
      background: #e8e8e8;
    }

    .detail-body {
      flex: 1;
      overflow-y: auto;
      padding: 8px 12px;
    }

    /* --- Detail content styles --- */
    .header-section {
      margin-bottom: 12px;
    }

    .header-section-title {
      font-family: system-ui, sans-serif;
      font-weight: 600;
      font-size: 11px;
      margin-bottom: 4px;
      color: #333;
    }

    .header-table {
      width: 100%;
      table-layout: auto;
      border-collapse: collapse;
    }

    .header-table td {
      padding: 1px 6px 1px 0;
      border: none;
      vertical-align: top;
      white-space: normal;
      word-break: break-all;
      cursor: default;
    }

    .header-table .h-name {
      color: #881280;
      white-space: nowrap;
      width: 1%;
      padding-right: 8px;
    }

    .header-table .h-val {
      color: #222;
    }

    .payload-raw, .response-raw {
      white-space: pre-wrap;
      word-break: break-all;
      font-size: 11px;
      line-height: 1.5;
    }

    .preview-frame {
      white-space: pre-wrap;
      word-break: break-all;
      font-size: 11px;
      line-height: 1.5;
    }

    /* --- JSON tree --- */
    .json-tree {
      font-size: 11px;
      line-height: 1.6;
    }

    .jt-row {
      white-space: nowrap;
    }

    .jt-toggle {
      display: inline-block;
      width: 12px;
      cursor: pointer;
      user-select: none;
      color: #888;
      text-align: center;
      flex-shrink: 0;
    }

    .jt-toggle:hover {
      color: #333;
    }

    .jt-key {
      color: #881280;
    }

    .jt-colon {
      color: #222;
    }

    .jt-str   { color: #c41a16; }
    .jt-num   { color: #1c00cf; }
    .jt-bool  { color: #0d6efd; }
    .jt-null  { color: #808080; }
    .jt-brace { color: #222; }

    .jt-summary {
      color: #888;
      font-style: italic;
      cursor: pointer;
    }

    .jt-children {
      padding-left: 16px;
    }

    .jt-children.collapsed {
      display: none;
    }

    .jt-ellipsis {
      display: none;
    }

    .jt-children.collapsed + .jt-ellipsis {
      display: inline;
    }

    @media (prefers-color-scheme: dark) {
      .jt-toggle       { color: #777; }
      .jt-toggle:hover  { color: #ccc; }
      .jt-key    { color: #c58af9; }
      .jt-colon  { color: #e8eaed; }
      .jt-str    { color: #f28b82; }
      .jt-num    { color: #8ab4f8; }
      .jt-bool   { color: #81c995; }
      .jt-null   { color: #9aa0a6; }
      .jt-brace  { color: #e8eaed; }
      .jt-summary { color: #9aa0a6; }
    }

    .general-url {
      color: #1a73e8;
      word-break: break-all;
    }

    /* --- Dark mode --- */
    @media (prefers-color-scheme: dark) {
      body { background: #292a2d; color: #e8eaed; }
      .toolbar { background: #3c3c3c; border-color: #555; }
      .toolbar .domain { color: #8ab4f8; }
      .toolbar button { background: #4a4a4a; color: #e8eaed; border-color: #666; }
      .toolbar button:hover { background: #5a5a5a; }
      .filter-bar { background: #353536; border-color: #555; }
      .filter-btn { color: #9aa0a6; }
      .filter-btn:hover { background: #4a4a4a; color: #e8eaed; }
      .filter-btn.active { background: #394457; color: #8ab4f8; }
      .search-input { background: #3c3c3c; color: #e8eaed; border-color: #555; }
      .search-input:focus { border-color: #8ab4f8; box-shadow: 0 0 0 1px rgba(138,180,248,0.3); }
      .search-input::placeholder { color: #777; }
      .filter-sep { background: #555; }
      th { background: #3c3c3c; border-color: #555; color: #9aa0a6; }
      td { border-color: #3c3c3c; }
      tr:hover td { background: #3c4043; }
      tr.selected td { background: #394457; }
      tr.selected:hover td { background: #394457; }
      .status-err { color: #f28b82; }
      .status-redirect { color: #fdd663; }
      .status-pending { color: #777; }
      tr.pending td { color: #777; }
      .size-cache { color: #777; }
      .path-name { color: #8ab4f8; }
      th[data-sort]:hover { color: #e8eaed; }
      .sort-arrow { color: #777; }
      .time-warn { color: #fdd663 !important; }
      .time-slow { color: #f28b82 !important; }
      @keyframes row-flash {
        0%   { background: #394457; }
        100% { background: transparent; }
      }
      .detail-pane { border-color: #555; }
      .detail-tabs { background: #3c3c3c; border-color: #555; }
      .detail-tab { color: #9aa0a6; }
      .detail-tab:hover { color: #e8eaed; background: #4a4a4a; }
      .detail-tab.active { color: #8ab4f8; border-bottom-color: #8ab4f8; }
      .detail-close:hover { color: #e8eaed; background: #4a4a4a; }
      .header-section-title { color: #e8eaed; }
      .header-table .h-name { color: #c58af9; }
      .header-table .h-val { color: #e8eaed; }
      .general-url { color: #8ab4f8; }
    }

    /* --- High Contrast theme --- */
    body.high-contrast { background: #000; color: #fff; }
    body.high-contrast .toolbar { background: #111; border-color: #fff; }
    body.high-contrast .toolbar .domain { color: #00e5ff; }
    body.high-contrast .toolbar button { background: #222; color: #fff; border-color: #888; }
    body.high-contrast .toolbar button:hover { background: #444; }
    body.high-contrast .toolbar button.active { background: #003d5c; color: #00e5ff; border-color: #00e5ff; }
    body.high-contrast .toolbar .count { color: #ccc; }
    body.high-contrast .filter-bar { background: #0a0a0a; border-color: #fff; }
    body.high-contrast .filter-btn { color: #ccc; }
    body.high-contrast .filter-btn:hover { background: #333; color: #fff; }
    body.high-contrast .filter-btn.active { background: #003d5c; color: #00e5ff; font-weight: 600; }
    body.high-contrast .search-input { background: #111; color: #fff; border-color: #888; }
    body.high-contrast .search-input:focus { border-color: #00e5ff; box-shadow: 0 0 0 1px #00e5ff; }
    body.high-contrast .search-input::placeholder { color: #888; }
    body.high-contrast .filter-sep { background: #666; }
    body.high-contrast th { background: #111; border-color: #fff; color: #fff; font-weight: 500; }
    body.high-contrast th[data-sort]:hover { color: #00e5ff; }
    body.high-contrast .sort-arrow { color: #00e5ff; }
    body.high-contrast td { border-color: #333; color: #fff; }
    body.high-contrast tr:hover td { background: #1a1a2e; }
    body.high-contrast tr.selected td { background: #003366; }
    body.high-contrast tr.selected:hover td { background: #003366; }
    body.high-contrast .status-err { color: #ff5252; }
    body.high-contrast .status-redirect { color: #ffff00; }
    body.high-contrast .status-pending { color: #888; }
    body.high-contrast tr.pending td { color: #888; }
    body.high-contrast .size-cache { color: #aaa; }
    body.high-contrast .path-name { color: #00e5ff; font-weight: 600; }
    body.high-contrast .time-warn { color: #ffff00 !important; }
    body.high-contrast .time-slow { color: #ff5252 !important; }
    body.high-contrast .empty-msg { color: #888; }
    @keyframes row-flash-hc {
      0%   { background: #003366; }
      100% { background: transparent; }
    }
    body.high-contrast tr.new-row td { animation: row-flash-hc 1.2s ease-out; }
    body.high-contrast .detail-pane { border-color: #fff; }
    body.high-contrast .detail-tabs { background: #111; border-color: #fff; }
    body.high-contrast .detail-tab { color: #ccc; }
    body.high-contrast .detail-tab:hover { color: #fff; background: #333; }
    body.high-contrast .detail-tab.active { color: #00e5ff; border-bottom-color: #00e5ff; }
    body.high-contrast .detail-close { color: #ccc; }
    body.high-contrast .detail-close:hover { color: #fff; background: #333; }
    body.high-contrast .header-section-title { color: #fff; font-weight: 600; }
    body.high-contrast .header-table .h-name { color: #ff80ab; }
    body.high-contrast .header-table .h-val { color: #fff; }
    body.high-contrast .general-url { color: #00e5ff; }
    body.high-contrast .jt-toggle { color: #aaa; }
    body.high-contrast .jt-toggle:hover { color: #fff; }
    body.high-contrast .jt-key { color: #ff80ab; }
    body.high-contrast .jt-colon { color: #fff; }
    body.high-contrast .jt-str { color: #ff8a80; }
    body.high-contrast .jt-num { color: #82b1ff; }
    body.high-contrast .jt-bool { color: #69f0ae; }
    body.high-contrast .jt-null { color: #aaa; }
    body.high-contrast .jt-brace { color: #fff; }
    body.high-contrast .jt-summary { color: #aaa; }
  </style>
</head>
<body>
  <div class="toolbar">
    <span class="domain" id="domain">&mdash;</span>
    <button id="clearBtn">Clear</button>
    <button id="themeBtn" title="Toggle High Contrast">HC</button>
    <span class="count" id="count"></span>
  </div>

  <div class="filter-bar" id="filterBar">
    <input type="text" class="search-input" id="searchInput" placeholder="Filter" />
    <div class="filter-sep"></div>
    <button class="filter-btn active" data-filter="all">All</button>
    <div class="filter-sep"></div>
    <button class="filter-btn" data-filter="api">API</button>
    <button class="filter-btn" data-filter="fetch">Fetch/XHR</button>
    <button class="filter-btn" data-filter="doc">Doc</button>
    <button class="filter-btn" data-filter="css">CSS</button>
    <button class="filter-btn" data-filter="js">JS</button>
    <button class="filter-btn" data-filter="img">Img</button>
    <button class="filter-btn" data-filter="media">Media</button>
    <button class="filter-btn" data-filter="font">Font</button>
    <button class="filter-btn" data-filter="ws">WS</button>
    <button class="filter-btn" data-filter="other">Other</button>
  </div>

  <div class="list-pane" id="listPane">
    <table>
      <thead>
        <tr>
          <th class="col-method" data-sort="method">Method</th>
          <th class="col-status" data-sort="status">Status</th>
          <th class="col-name" data-sort="name">Name</th>
          <th class="col-type" data-sort="type">Type</th>
          <th class="col-size" data-sort="size">Size</th>
          <th class="col-time" data-sort="time">Time</th>
        </tr>
      </thead>
      <tbody id="tbody"></tbody>
    </table>
    <div class="empty-msg" id="emptyMsg">Waiting for requests&hellip;</div>
  </div>

  <div class="detail-pane" id="detailPane">
    <div class="detail-tabs" id="detailTabs">
      <div class="detail-tab active" data-tab="headers">Headers</div>
      <div class="detail-tab" data-tab="payload">Payload</div>
      <div class="detail-tab" data-tab="preview">Preview</div>
      <div class="detail-tab" data-tab="response">Response</div>
      <div class="detail-close" id="detailClose">&times;</div>
    </div>
    <div class="detail-body" id="detailBody"></div>
  </div>

  <script src="panel.js"></script>
</body>
</html>
